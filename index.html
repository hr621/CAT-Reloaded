<!DOCTYPE html>
<html dir="rtl" lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Orientation Day - CAT Reloaded</title>
    <style>
        :root { --primary: #800000; --text: #333; --bg: #f4f4f4; --accent: #d35400; --shady: #e91e63; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: var(--bg); margin: 0; padding-bottom: 80px; }
        
        .hero-image { width: 100%; max-height: 350px; object-fit: cover; display: block; border-bottom: 5px solid var(--primary); }
        .page-title { text-align: center; color: var(--primary); font-size: 2.2rem; margin: 20px 0; text-transform: uppercase; letter-spacing: 1px; font-weight: 900; }
        .container { max-width: 800px; margin: 0 auto; padding: 15px; }

        .card { background: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 10px rgba(0,0,0,0.08); margin-bottom: 20px; border-top: 4px solid var(--primary); }
        .card.shady-card { border-top-color: var(--shady); }
        h3 { color: var(--primary); margin-top: 0; border-bottom: 1px solid #eee; padding-bottom: 10px; font-size: 1.3rem; }
        .shady-title { color: var(--shady); }
        
        /* Ø¨Ø§Ø¯Ø¬ Ø§Ù„Ø®ØµÙ… */
        .discount-badge { background: #ffeb3b; color: #d32f2f; padding: 5px 10px; border-radius: 15px; font-size: 0.8rem; font-weight: bold; margin-right: 10px; vertical-align: middle; animation: pulse 2s infinite; }
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.05); } 100% { transform: scale(1); } }

        .input-group { margin-bottom: 15px; }
        .input-group label { display: block; margin-bottom: 5px; font-weight: bold; color: #555; }
        .input-group input { width: 100%; padding: 12px; border: 1px solid #ccc; border-radius: 8px; box-sizing: border-box; font-size: 1rem; }
        
        .choice-container { display: flex; gap: 15px; justify-content: center; margin: 15px 0; }
        .choice-label { cursor: pointer; display: flex; align-items: center; gap: 8px; padding: 10px 20px; background: #eee; border-radius: 25px; transition: 0.3s; font-weight: bold; }
        .choice-label:hover { background: #e0e0e0; }
        input[type="radio"]:checked + span { color: var(--primary); }
        .shady-choice input[type="radio"]:checked + span { color: var(--shady); }

        .category-header { background: #2c3e50; color: white; padding: 15px; border-radius: 8px; margin-top: 15px; font-weight: bold; font-size: 1.1rem; cursor: pointer; display: flex; justify-content: space-between; align-items: center; transition: background 0.3s; }
        .category-header:hover { background: #34495e; }
        .category-header.shady-header { background: var(--shady); }
        .category-header.shady-header:hover { background: #c2185b; }
        
        .arrow-icon { transition: transform 0.3s ease; font-size: 0.8rem; }
        .category-header.active .arrow-icon { transform: rotate(180deg); }

        .items-container { display: none; background: #fff; padding: 0 10px; border: 1px solid #eee; border-top: none; border-bottom-left-radius: 8px; border-bottom-right-radius: 8px; animation: fadeIn 0.3s ease; }
        .items-container.show { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(-5px); } to { opacity: 1; transform: translateY(0); } }

        .menu-item { display: flex; justify-content: space-between; align-items: center; padding: 12px 0; border-bottom: 1px solid #f0f0f0; }
        .item-details { flex: 1; padding-left: 10px; }
        .item-details h4 { margin: 0; color: #333; font-size: 1rem; }
        .item-details p { margin: 4px 0 0; font-size: 0.85rem; color: #777; }
        
        .item-price { color: var(--accent); font-weight: bold; display: block; margin-top: 2px; }
        .shady-price { color: var(--shady); }
        /* Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ù‚Ø¯ÙŠÙ… Ø§Ù„Ù…Ø´Ø·ÙˆØ¨ */
        .old-price { text-decoration: line-through; color: #999; font-size: 0.85rem; margin-left: 5px; font-weight: normal; }

        .qty-control { display: flex; align-items: center; gap: 8px; background: #f9f9f9; padding: 4px; border-radius: 20px; }
        .qty-btn { width: 28px; height: 28px; border-radius: 50%; border: none; background: var(--primary); color: white; cursor: pointer; font-size: 1.2rem; display: flex; align-items: center; justify-content: center; padding-bottom: 3px; }
        .qty-btn.shady-btn { background: var(--shady); }
        
        .payment-box { text-align: center; border: 2px dashed var(--primary); padding: 20px; background: #fffdfd; border-radius: 10px; }
        .vf-number { font-size: 1.6rem; font-weight: bold; color: #d35400; display: block; margin: 10px 0; letter-spacing: 1px; }

        .hidden { display: none; }
        .submit-btn { width: 100%; padding: 16px; background: var(--primary); color: white; border: none; font-size: 1.2rem; font-weight: bold; border-radius: 8px; cursor: pointer; margin-top: 10px; }
        .submit-btn:hover { background: #600000; }
    </style>
</head>
<body>

    <img src="accepted.final.jpg" alt="CAT Reloaded" class="hero-image">
    <h1 class="page-title">Orientation Day</h1>

    <div class="container">
        
        <div class="card">
            <h3>ğŸ“ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´Ø®ØµÙŠØ©</h3>
            <div class="input-group"><label>Ø§Ù„Ø§Ø³Ù… Ø¨Ø§Ù„ÙƒØ§Ù…Ù„:</label><input type="text" id="name"></div>
            <div class="input-group"><label>Ø±Ù‚Ù… Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„:</label><input type="tel" id="phone"></div>
            <div class="input-group"><label>Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„:</label><input type="email" id="email"></div>
            <div class="input-group"><label>CAT-ID:</label><input type="text" id="catId" placeholder="ex: 111-111"></div>
        </div>

        <div class="card" style="text-align: center;">
            <h3>ğŸ½ï¸ Ù‡ØªØ·Ù„Ø¨ ØºØ¯Ø§Ø¡ (Ø±ÙˆØ­ Ø¯Ù…Ø´Ù‚)ØŸ</h3>
            <div class="choice-container">
                <label class="choice-label"><input type="radio" name="lunchChoice" value="yes" onchange="toggleLunch()"> <span>Ù†Ø¹Ù…ØŒ Ø³Ø£Ø·Ù„Ø¨</span></label>
                <label class="choice-label"><input type="radio" name="lunchChoice" value="no" checked onchange="toggleLunch()"> <span>Ù„Ø§</span></label>
            </div>
        </div>

        <div id="lunchSection" class="hidden">
            <div class="card">
                <h3>ğŸ“œ Ù…Ù†ÙŠÙˆ Ø±ÙˆØ­ Ø¯Ù…Ø´Ù‚ (Ø§Ø¶ØºØ· Ù„Ù„ÙØªØ­)</h3>
                <div id="menuContainer"></div>
            </div>
        </div>

        <div class="card shady-card" style="text-align: center;">
            <h3 class="shady-title">ğŸ© ØªØ·Ù„Ø¨ Ø­Ù„ÙˆÙˆ (Ø´Ø§Ø¯ÙŠ Ø¯ÙˆÙ†Ø§ØªØ³)ØŸ <span class="discount-badge">ğŸ”¥ Ø®ØµÙ… 20%</span></h3>
            <div class="choice-container shady-choice">
                <label class="choice-label"><input type="radio" name="shadyChoice" value="yes" onchange="toggleShady()"> <span>Ù†Ø¹Ù…ØŒ Ø³Ø£Ø­Ù„ÙŠ</span></label>
                <label class="choice-label"><input type="radio" name="shadyChoice" value="no" checked onchange="toggleShady()"> <span>Ù„Ø§</span></label>
            </div>
        </div>

        <div id="shadySection" class="hidden">
            <div class="card shady-card">
                <h3 class="shady-title">ğŸ© Ù…Ù†ÙŠÙˆ Ø´Ø§Ø¯ÙŠ (Ø§Ù„Ø£Ø³Ø¹Ø§Ø± Ø¨Ø¹Ø¯ Ø§Ù„Ø®ØµÙ…)</h3>
                <div id="shadyMenuContainer"></div>
            </div>
        </div>

        <div id="paymentSection" class="hidden">
            <div class="card">
                <h3>ğŸ’³ Ø§Ù„Ø¯ÙØ¹ ÙˆØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨</h3>
                <div class="payment-box">
                    <p>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨: <span id="displayTotal" style="font-weight:bold; font-size:1.4rem">0</span> Ø¬.Ù…</p>
                    <hr>
                    <p>Ø­ÙˆÙ„ Ø§Ù„Ù…Ø¨Ù„Øº ÙÙˆØ¯Ø§ÙÙˆÙ† ÙƒØ§Ø´ Ø¹Ù„Ù‰:</p>
                    <span class="vf-number">01050910968</span>
                    <label style="display:block; margin-top:15px; cursor:pointer; background:#eee; padding:12px; border-radius:8px;">
                        ğŸ“¸ Ø§Ø¶ØºØ· Ù„Ø±ÙØ¹ Ø³ÙƒØ±ÙŠÙ† Ø´ÙˆØª Ø§Ù„ØªØ­ÙˆÙŠÙ„
                        <input type="file" id="receiptFile" accept="image/*" style="display:none" onchange="previewFile()">
                    </label>
                    <div id="fileName" style="margin-top:8px; color:green; font-weight:bold; font-size:0.9rem;"></div>
                </div>
            </div>
        </div>

        <button class="submit-btn" onclick="submitForm()" id="mainBtn">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø­Ø¶ÙˆØ± âœ…</button>
    </div>

<script>
    // ============================================================
    // âš ï¸ Ø¶Ø¹ Ø±Ø§Ø¨Ø· Ø§Ù„Ø¬ÙˆØ¬Ù„ Ø³ÙƒØ±Ø¨Øª Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ Ù‡Ù†Ø§
    // ============================================================
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbwBfy4LssvIAzn35IKgMDyYO2R220Ph0rA99MR1S8DPPMlXKHzAix2ihFxErVOqyHOY/exec";

    let cart = {};
    let totalLunch = 0;
    let totalShady = 0;

    // ================== Ù‚Ø§Ø¹Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø±ÙˆØ­ Ø¯Ù…Ø´Ù‚ ==================
    const menuDB = [
        { cat: "ğŸ“¦ Ø¨ÙˆÙƒØ³Ø§Øª Ø§Ù„Ù„Ù…Ø© ÙˆØ§Ù„ØµØ­Ø§Ø¨", items: [
            {n:"Ø¨ÙˆÙƒØ³ Ø§Ù„Ù„Ù…Ø© (ÙØ±Ø§Ø®)", p:420, d:"5 Ø³Ù†Ø¯ÙˆØªØ´Ø§Øª Ù„Ø§Ø±Ø¬ Ù…Ù‚Ø·Ø¹ÙŠÙ†"},
            {n:"Ø¨ÙˆÙƒØ³ Ø§Ù„Ù„Ù…Ø© (Ù„Ø­Ù…Ø©)", p:610, d:"5 Ø³Ù†Ø¯ÙˆØªØ´Ø§Øª Ù„Ø§Ø±Ø¬ Ù…Ù‚Ø·Ø¹ÙŠÙ†"},
            {n:"Ø¨ÙˆÙƒØ³ Ø§Ù„Ù„Ù…Ø© (Ù…ÙŠÙƒØ³)", p:500, d:"5 Ø³Ù†Ø¯ÙˆØªØ´Ø§Øª Ù„Ø§Ø±Ø¬ Ù…Ù‚Ø·Ø¹ÙŠÙ†"},
            {n:"Ø¨ÙˆÙƒØ³ Ø§Ù„ØµØ­Ø§Ø¨ (ÙØ±Ø§Ø®)", p:250, d:"4 Ø³Ù†Ø¯ÙˆØªØ´Ø§Øª ÙƒØ§ÙŠØ²Ø±"},
            {n:"Ø¨ÙˆÙƒØ³ Ø§Ù„ØµØ­Ø§Ø¨ (Ù„Ø­Ù…Ø©)", p:350, d:"4 Ø³Ù†Ø¯ÙˆØªØ´Ø§Øª ÙƒØ§ÙŠØ²Ø±"},
            {n:"Ø¨ÙˆÙƒØ³ Ø§Ù„ØµØ­Ø§Ø¨ (Ù…ÙŠÙƒØ³)", p:300, d:"4 Ø³Ù†Ø¯ÙˆØªØ´Ø§Øª ÙƒØ§ÙŠØ²Ø±"},
            {n:"Ø¨ÙˆÙƒØ³ Ø±ÙˆØ­ Ø¯Ù…Ø´Ù‚ (ÙØ±Ø§Ø®)", p:230, d:"2 XL Ù…Ù‚Ø·Ø¹ÙŠÙ† + 3 ÙƒØ±ÙŠØ³Ø¨ÙŠ"},
            {n:"Ø¨ÙˆÙƒØ³ Ø±ÙˆØ­ Ø¯Ù…Ø´Ù‚ (Ù„Ø­Ù…Ø©)", p:350, d:"2 XL Ù…Ù‚Ø·Ø¹ÙŠÙ† + 3 ÙƒØ±ÙŠØ³Ø¨ÙŠ"},
            {n:"Ø¨ÙˆÙƒØ³ Ø±ÙˆØ­ Ø¯Ù…Ø´Ù‚ (Ù…ÙŠÙƒØ³)", p:290, d:"2 XL Ù…Ù‚Ø·Ø¹ÙŠÙ† + 3 ÙƒØ±ÙŠØ³Ø¨ÙŠ"},
            {n:"Ø¨ÙˆÙƒØ³ Ø§Ù„Ù…Ù„ÙˆÙƒ (ÙØ±Ø§Ø®)", p:350, d:"5 ÙƒØ±ÙŠØ³Ø¨ÙŠ + 5 Ø´Ø§ÙˆØ±Ù…Ø§"},
            {n:"Ø¨ÙˆÙƒØ³ Ø§Ù„Ù…Ù„ÙˆÙƒ (Ù„Ø­Ù…Ø©)", p:430, d:"5 ÙƒØ±ÙŠØ³Ø¨ÙŠ + 5 Ø´Ø§ÙˆØ±Ù…Ø§"},
            {n:"Ø¨ÙˆÙƒØ³ Ø§Ù„Ø­ÙƒØ§ÙŠØ©", p:400, d:"10 Ø³ÙˆØ±ÙŠ ÙØ±Ø§Ø® 10Ø³Ù…"}
        ]},
        { cat: "ğŸ†• Ø§Ù„Ø¨ÙˆÙƒØ³Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©", items: [
            {n:"Ø¨ÙˆÙƒØ³ Ø¯Ù…ÙŠØ§Ø· Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©", p:235, d:"2 Ø¨Ø±ÙˆØ³ØªØ¯ + 4 ÙƒØ±ÙŠØ³Ø¨ÙŠ"},
            {n:"Ø¨ÙˆÙƒØ³ Ø§Ù„Ù…Ù†ØµÙˆØ±Ø©", p:385, d:"Ù…Ø§Ø±ÙŠØ§ + 2 Ø³ ÙØ±Ø§Ø® + Ø³ Ù„Ø­Ù…Ø©"},
            {n:"Ø¨ÙˆÙƒØ³ Ø§Ù„Ø¹Ø¨ÙˆØ±", p:315, d:"Ù†Øµ Ø´ÙˆØ§ÙŠØ© + 4 ÙƒØ±ÙŠØ³Ø¨ÙŠ"},
            {n:"Ø¨ÙˆÙƒØ³ Ø·Ù†Ø·Ø§ (ÙØ±Ø§Ø®)", p:445, d:"8 ÙƒØ§ÙŠØ²Ø± ÙØ±Ø§Ø®"},
            {n:"Ø¨ÙˆÙƒØ³ Ø·Ù†Ø·Ø§ (Ù„Ø­Ù…Ø©)", p:700, d:"8 ÙƒØ§ÙŠØ²Ø± Ù„Ø­Ù…Ø©"},
            {n:"Ø¨ÙˆÙƒØ³ Ø·Ù†Ø·Ø§ (Ù…ÙŠÙƒØ³)", p:550, d:"4 ÙØ±Ø§Ø® + 4 Ù„Ø­Ù…Ø©"}
        ]},
        { cat: "ğŸ¥˜ Ø¨ÙˆÙƒØ³Ø§Øª Ù…ØµØ±Ø§ÙˆÙŠ", items: [
            {n:"Ù…ØµØ±Ø§ÙˆÙŠ Ø´Ø§ÙˆØ±Ù…Ø§ ÙØ±Ø§Ø® (ØµØºÙŠØ±)", p:135}, {n:"Ù…ØµØ±Ø§ÙˆÙŠ Ø´Ø§ÙˆØ±Ù…Ø§ ÙØ±Ø§Ø® (ÙƒØ¨ÙŠØ±)", p:245},
            {n:"Ù…ØµØ±Ø§ÙˆÙŠ Ø´Ø§ÙˆØ±Ù…Ø§ Ù„Ø­Ù…Ø© (ØµØºÙŠØ±)", p:215}, {n:"Ù…ØµØ±Ø§ÙˆÙŠ Ø´Ø§ÙˆØ±Ù…Ø§ Ù„Ø­Ù…Ø© (ÙƒØ¨ÙŠØ±)", p:340},
            {n:"Ù…ØµØ±Ø§ÙˆÙŠ ÙƒØ±ÙŠØ³Ø¨ÙŠ (ØµØºÙŠØ±)", p:160}, {n:"Ù…ØµØ±Ø§ÙˆÙŠ ÙƒØ±ÙŠØ³Ø¨ÙŠ (ÙƒØ¨ÙŠØ±)", p:295},
            {n:"Ù…ØµØ±Ø§ÙˆÙŠ Ø´ÙŠØ´ (ØµØºÙŠØ±)", p:135}, {n:"Ù…ØµØ±Ø§ÙˆÙŠ Ø´ÙŠØ´ (ÙƒØ¨ÙŠØ±)", p:245}
        ]},
        { cat: "ğŸŒ¯ Ø³Ù†Ø¯ÙˆØªØ´Ø§Øª ÙˆÙˆØ¬Ø¨Ø§Øª Ø§Ù„Ø´Ø§ÙˆØ±Ù…Ø§", items: [
            {n:"Ø³Ù†Ø¯ÙˆØªØ´ ÙØ±Ø§Ø® (Ù„Ø§Ø±Ø¬)", p:75}, {n:"Ø³Ù†Ø¯ÙˆØªØ´ ÙØ±Ø§Ø® (XL)", p:85},
            {n:"Ø³Ù†Ø¯ÙˆØªØ´ Ù„Ø­Ù…Ø© (Ù„Ø§Ø±Ø¬)", p:105}, {n:"Ø³Ù†Ø¯ÙˆØªØ´ Ù„Ø­Ù…Ø© (XL)", p:120},
            {n:"Ø³Ù†Ø¯ÙˆØªØ´ ÙØ±Ø§Ø® ÙƒØ§ÙŠØ²Ø±", p:70}, {n:"Ø³Ù†Ø¯ÙˆØªØ´ Ù„Ø­Ù…Ø© ÙƒØ§ÙŠØ²Ø±", p:90},
            {n:"Ø³Ù†Ø¯ÙˆØªØ´ ÙØ±Ø§Ø® ÙØ±Ù†Ø³Ø§ÙˆÙŠ", p:95}, {n:"Ø³Ù†Ø¯ÙˆØªØ´ Ù„Ø­Ù…Ø© ÙØ±Ù†Ø³Ø§ÙˆÙŠ", p:125},
            {n:"ÙˆØ¬Ø¨Ø© Ø¹Ø±Ø¨ÙŠ (ÙØ±Ø§Ø®)", p:120, d:"Ø³Ù†Ø¯ÙˆØªØ´ Ù…Ù‚Ø·Ø¹ + Ø¨Ø·Ø§Ø·Ø³"},
            {n:"ÙˆØ¬Ø¨Ø© Ø¹Ø±Ø¨ÙŠ (Ù„Ø­Ù…Ø©)", p:145, d:"Ø³Ù†Ø¯ÙˆØªØ´ Ù…Ù‚Ø·Ø¹ + Ø¨Ø·Ø§Ø·Ø³"},
            {n:"ÙˆØ¬Ø¨Ø© Ø¹Ø±Ø¨ÙŠ Ø¯Ø¨Ù„ (ÙØ±Ø§Ø®)", p:190}, {n:"ÙˆØ¬Ø¨Ø© Ø¹Ø±Ø¨ÙŠ Ø¯Ø¨Ù„ (Ù„Ø­Ù…Ø©)", p:260},
            {n:"ÙˆØ¬Ø¨Ø© Ø¹Ø±Ø¨ÙŠ Ø¯Ø¨Ù„ (Ù…ÙŠÙƒØ³)", p:220}
        ]},
        { cat: "ğŸ¥– Ø§Ù„Ø´ÙˆÙ…Ø© (Ù†Øµ Ù…ØªØ±)", items: [
            {n:"Ø´ÙˆÙ…Ø© Ø³ÙˆØ±ÙŠ ÙØ±Ø§Ø®", p:140}, {n:"Ø´ÙˆÙ…Ø© ÙØ±Ù†Ø³Ø§ÙˆÙŠ ÙØ±Ø§Ø®", p:150},
            {n:"Ø´ÙˆÙ…Ø© Ø³ÙˆØ±ÙŠ Ù„Ø­Ù…Ø©", p:205}, {n:"Ø´ÙˆÙ…Ø© ÙØ±Ù†Ø³Ø§ÙˆÙŠ Ù„Ø­Ù…Ø©", p:210},
            {n:"Ø´ÙˆÙ…Ø© Ø³ÙˆØ±ÙŠ ÙƒØ±ÙŠØ³Ø¨ÙŠ", p:145}, {n:"Ø´ÙˆÙ…Ø© ÙØ±Ù†Ø³Ø§ÙˆÙŠ ÙƒØ±ÙŠØ³Ø¨ÙŠ", p:150},
            {n:"Ø´ÙˆÙ…Ø© Ø³ÙˆØ±ÙŠ Ø²Ù†Ø¬Ø±", p:145}, {n:"Ø´ÙˆÙ…Ø© ÙØ±Ù†Ø³Ø§ÙˆÙŠ Ø²Ù†Ø¬Ø±", p:150},
            {n:"Ø´ÙˆÙ…Ø© Ø³ÙˆØ±ÙŠ Ø´ÙŠØ´", p:145}, {n:"Ø´ÙˆÙ…Ø© ÙØ±Ù†Ø³Ø§ÙˆÙŠ Ø´ÙŠØ´", p:150},
            {n:"Ø´ÙˆÙ…Ø© Ø³ÙˆØ¨Ø±ÙŠÙ… Ø±Ø§Ù†Ø´", p:170}
        ]},
        { cat: "ğŸŒ® Ø§Ù„Ù…Ø§Ø±ÙŠØ§ ÙˆØ§Ù„Ø¯Ù„ÙˆØ¹Ø©", items: [
            {n:"Ù…Ø§Ø±ÙŠØ§ Ø´Ø§ÙˆØ±Ù…Ø§ ÙØ±Ø§Ø®", p:120}, {n:"Ù…Ø§Ø±ÙŠØ§ ÙØ±Ø§Ø® Ù…ÙˆØªØ²Ø±ÙŠÙ„Ø§", p:135},
            {n:"Ù…Ø§Ø±ÙŠØ§ Ø´Ø§ÙˆØ±Ù…Ø§ Ù„Ø­Ù…Ø©", p:155}, {n:"Ù…Ø§Ø±ÙŠØ§ Ù„Ø­Ù…Ø© Ù…ÙˆØªØ²Ø±ÙŠÙ„Ø§", p:170},
            {n:"Ù…Ø§Ø±ÙŠØ§ ØªØ´ÙŠØ²ÙŠ ÙƒØ±ÙŠØ³Ø¨ÙŠ", p:130}, {n:"Ù…Ø§Ø±ÙŠØ§ Ù…ÙŠÙƒØ³", p:145},
            {n:"Ø§Ù„Ø¯Ù„ÙˆØ¹Ø© ÙØ±Ø§Ø®", p:135}, {n:"Ø§Ù„Ø¯Ù„ÙˆØ¹Ø© Ù„Ø­Ù…Ø©", p:160}, {n:"Ø§Ù„Ø¯Ù„ÙˆØ¹Ø© ÙƒØ±ÙŠØ³Ø¨ÙŠ", p:125}
        ]},
        { cat: "ğŸ” Ø§Ù„Ø³Ù†Ø¯ÙˆØªØ´Ø§Øª Ø§Ù„ØºØ±Ø¨ÙŠ", items: [
            {n:"Ø³Ù†Ø¯ÙˆØªØ´ ÙƒØ±ÙŠØ³Ø¨ÙŠ (Ø³ÙˆØ±ÙŠ)", p:95}, {n:"Ø³Ù†Ø¯ÙˆØªØ´ ÙƒØ±ÙŠØ³Ø¨ÙŠ (ÙØ±Ù†Ø³Ø§ÙˆÙŠ)", p:100},
            {n:"Ø³Ù†Ø¯ÙˆØªØ´ Ø²Ù†Ø¬Ø± (Ø³ÙˆØ±ÙŠ)", p:100}, {n:"Ø³Ù†Ø¯ÙˆØªØ´ Ø²Ù†Ø¬Ø± (ÙØ±Ù†Ø³Ø§ÙˆÙŠ)", p:100},
            {n:"Ø³Ù†Ø¯ÙˆØªØ´ ØªØ´ÙŠØ² Ø¨Ø±ØºØ± Ù„Ø­Ù…", p:95}, {n:"Ø³Ù†Ø¯ÙˆØªØ´ Ù‡Ø§Ù„Ùƒ Ø¯Ø¨Ù„ ÙƒØ±ÙŠØ³Ø¨ÙŠ", p:150},
            {n:"Ø³Ù†Ø¯ÙˆØªØ´ Ø´ÙŠØ´ (Ø³ÙˆØ±ÙŠ)", p:95}, {n:"Ø³Ù†Ø¯ÙˆØªØ´ Ø´ÙŠØ´ (ÙØ±Ù†Ø³Ø§ÙˆÙŠ)", p:100},
            {n:"Ø³Ù†Ø¯ÙˆØªØ´ Ø¨Ø·Ø§Ø·Ø³ (Ø³ÙˆØ±ÙŠ)", p:50}, {n:"Ø³Ù†Ø¯ÙˆØªØ´ Ø¨Ø·Ø§Ø·Ø³ (ÙØ±Ù†Ø³Ø§ÙˆÙŠ)", p:60},
            {n:"Ø³Ù†Ø¯ÙˆØªØ´ Ø¨Ø·Ø§Ø·Ø³ Ù…ÙˆØªØ²Ø±ÙŠÙ„Ø§", p:65}
        ]},
        { cat: "ğŸ½ï¸ ÙˆØ¬Ø¨Ø§Øª Ø§Ù„ØºØ±Ø¨ÙŠ ÙˆØ§Ù„Ø¨Ø±ÙˆØ³ØªØ¯", items: [
            {n:"ÙˆØ¬Ø¨Ø© Ø¨Ø±ÙˆØ³ØªØ¯ 2 Ù‚Ø·Ø¹Ø©", p:125}, {n:"ÙˆØ¬Ø¨Ø© Ø¨Ø±ÙˆØ³ØªØ¯ 4 Ù‚Ø·Ø¹", p:210},
            {n:"ÙˆØ¬Ø¨Ø© Ø¨Ø±ÙˆØ³ØªØ¯ 8 Ù‚Ø·Ø¹", p:400},
            {n:"ÙØ±Ø®Ø© Ù…Ø´ÙˆÙŠØ© (Ø£Ø±Ø² ÙˆØ¨Ø·Ø§Ø·Ø³)", p:380}, {n:"Ù†Øµ ÙØ±Ø®Ø© Ù…Ø´ÙˆÙŠØ© (Ø£Ø±Ø²)", p:200},
            {n:"ÙˆØ¬Ø¨Ø© 5 Ù‚Ø·Ø¹ ÙƒØ±ÙŠØ³Ø¨ÙŠ", p:160}, {n:"ÙˆØ¬Ø¨Ø© 5 Ù‚Ø·Ø¹ Ø²Ù†Ø¬Ø±", p:165},
            {n:"ÙˆØ¬Ø¨Ø© Ø´ÙŠØ´ Ø·Ø§ÙˆÙˆÙ‚", p:150}, {n:"ÙˆØ¬Ø¨Ø© Ù…ÙŠÙƒØ³ ÙØ±Ø§Ø® ÙˆØ±Ùƒ", p:145},
            {n:"ÙˆØ¬Ø¨Ø© Ù…ÙŠÙƒØ³ ÙØ±Ø§Ø® ØµØ¯Ø±", p:165}
        ]},
        { cat: "ğŸ¥˜ Ø§Ù„ÙØªØ§Øª", items: [
            {n:"ÙØªØ© Ø´Ø§ÙˆØ±Ù…Ø§ ÙØ±Ø§Ø® (S)", p:100}, {n:"ÙØªØ© Ø´Ø§ÙˆØ±Ù…Ø§ ÙØ±Ø§Ø® (L)", p:120},
            {n:"ÙØªØ© Ø´Ø§ÙˆØ±Ù…Ø§ Ù„Ø­Ù…Ø© (S)", p:120}, {n:"ÙØªØ© Ø´Ø§ÙˆØ±Ù…Ø§ Ù„Ø­Ù…Ø© (L)", p:150},
            {n:"ÙØªØ© Ù…ÙŠÙƒØ³ (S)", p:115}, {n:"ÙØªØ© Ù…ÙŠÙƒØ³ (L)", p:140},
            {n:"ÙØªØ© Ø±ÙŠØ²Ùˆ ÙƒØ±ÙŠØ³Ø¨ÙŠ", p:110}, {n:"ÙØªØ© Ø´ÙŠØ´ Ø·Ø§ÙˆÙˆÙ‚", p:110}
        ]},
        { cat: "ğŸŒ® Ø§Ù„ÙƒØ±ÙŠØ¨", items: [
            {n:"ÙƒØ±ÙŠØ¨ Ø´Ø§ÙˆØ±Ù…Ø§ ÙØ±Ø§Ø®", p:100}, {n:"ÙƒØ±ÙŠØ¨ Ø´Ø§ÙˆØ±Ù…Ø§ Ù„Ø­Ù…Ø©", p:130},
            {n:"ÙƒØ±ÙŠØ¨ ÙƒØ±ÙŠØ³Ø¨ÙŠ", p:100}, {n:"ÙƒØ±ÙŠØ¨ Ø²Ù†Ø¬Ø±", p:105},
            {n:"ÙƒØ±ÙŠØ¨ Ø´ÙŠØ´", p:100}, {n:"ÙƒØ±ÙŠØ¨ Ù…Ø´ÙƒÙ„ Ø¬Ø¨Ù†", p:70},
            {n:"ÙƒØ±ÙŠØ¨ Ù†ÙˆØªÙŠÙ„Ø§", p:70}, {n:"ÙƒØ±ÙŠØ¨ Ø³ÙˆÙŠØª Ø´ÙŠÙ„ÙŠ", p:110}
        ]},
        { cat: "ğŸŸ Ø§Ù„Ù…Ù‚Ø¨Ù„Ø§Øª ÙˆØ§Ù„Ù…Ø´Ø±ÙˆØ¨Ø§Øª", items: [
            {n:"Ø¨Ø§ÙƒÙŠØª Ø¨Ø·Ø§Ø·Ø³", p:25}, {n:"Ø¨Ø·Ø§Ø·Ø³ Ø´ÙŠØ¯Ø±", p:50},
            {n:"Ø·Ø¨Ù‚ Ø£Ø±Ø²", p:35}, {n:"ØªÙˆÙ…ÙŠØ©", p:15}, {n:"ÙƒÙˆÙ„ Ø³Ù„Ùˆ", p:20},
            {n:"Ø£ØµØ§Ø¨Ø¹ Ù…ÙˆØªØ²Ø±ÙŠÙ„Ø§", p:35}, {n:"Ù…ÙŠØ§Ù‡ Ù…Ø¹Ø¯Ù†ÙŠØ©", p:10}, {n:"V Cola", p:25}
        ]}
    ];

    // ================== Ù‚Ø§Ø¹Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø´Ø§Ø¯ÙŠ Ø¯ÙˆÙ†Ø§ØªØ³ (ØªÙ… ØªØ·Ø¨ÙŠÙ‚ Ø®ØµÙ… 20%) ==================
    // Ø§Ù„Ù…Ø¹Ø§Ø¯Ù„Ø©: Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ù‚Ø¯ÙŠÙ… * 0.8
    const shadyDB = [
        { cat: "ğŸ© Ø¯ÙˆÙ†Ø§ØªØ³ Ù…Ø­Ø´ÙŠØ© (Stuffed)", items: [
            {n:"Nutella", p:44, oldP:55}, {n:"Lotus", p:44, oldP:55}, {n:"Kinder", p:44, oldP:55},
            {n:"Ferrero Rocher", p:48, oldP:60}, {n:"Pistachio", p:56, oldP:70}, {n:"Mocha", p:48, oldP:60},
            {n:"Carmel", p:48, oldP:60}, {n:"Dreamy", p:44, oldP:55}, {n:"Dreamy Strawberry", p:48, oldP:60},
            {n:"Dreamy Berry", p:48, oldP:60}, {n:"Dreamy Cherry", p:48, oldP:60}, {n:"White Chocolate", p:44, oldP:55},
            {n:"Nutella Oreo", p:48, oldP:60}, {n:"Kunafa Nutella", p:48, oldP:60}, {n:"Kunafa Kinder", p:48, oldP:60},
            {n:"Kunafa Lotus", p:48, oldP:60}, {n:"Kunafa Pistachio", p:60, oldP:75}
        ]},
        { cat: "ğŸ¥¯ Ø¯ÙˆÙ†Ø§ØªØ³ Ø£ÙˆØ±ÙŠØ¬ÙŠÙ†Ø§Ù„ (Original)", items: [
            {n:"Nutella", p:40, oldP:50}, {n:"Nutella Nuts", p:48, oldP:60}, {n:"Glezd", p:40, oldP:50},
            {n:"White Chocolate", p:40, oldP:50}, {n:"Ferrero Rocher", p:44, oldP:55}, {n:"White Berry", p:48, oldP:60},
            {n:"White Strawberry", p:48, oldP:60}, {n:"White Cherry", p:48, oldP:60}, {n:"Carmel", p:40, oldP:50},
            {n:"Pistachio", p:52, oldP:65}, {n:"Nutella Oreo", p:44, oldP:55}, {n:"Kunafa Nutella", p:44, oldP:55},
            {n:"Kunafa Kinder", p:44, oldP:55}, {n:"Kunafa Lotus", p:44, oldP:55}, {n:"Kunafa Pistachio", p:56, oldP:70}
        ]},
        { cat: "ğŸ“¦ Ù…ÙŠÙ†ÙŠ Ø¯ÙˆÙ†Ø§ØªØ³ (Mini Donuts)", items: [
            {n:"Box 6 Pcs", p:112, oldP:140}, {n:"Box 12 Pcs", p:220, oldP:275}, {n:"Box 24 Pcs", p:432, oldP:540}
        ]},
        { cat: "âœ¨ Ø¹Ø±ÙˆØ¶ Ø®Ø§ØµØ© (Ù…Ø­Ø´ÙŠØ©)", items: [
            {n:"Box 6 Pcs (Max 2 Pistachio)", p:248, oldP:310},
            {n:"Box 12 Pcs (Max 4 Pistachio)", p:496, oldP:620},
            {n:"Box 18 Pcs (Max 6 Pistachio)", p:744, oldP:930}
        ]},
        { cat: "âœ¨ Ø¹Ø±ÙˆØ¶ Ø®Ø§ØµØ© (Ø£ÙˆØ±ÙŠØ¬ÙŠÙ†Ø§Ù„)", items: [
            {n:"Box 6 Pcs (Max 2 Pistachio)", p:232, oldP:290},
            {n:"Box 12 Pcs (Max 4 Pistachio)", p:464, oldP:580},
            {n:"Box 18 Pcs (Max 6 Pistachio)", p:712, oldP:890}
        ]}
    ];

    function buildMenu(database, containerId, prefix, btnClass = '') {
        const container = document.getElementById(containerId);
        database.forEach((category, i) => {
            let html = `
            <div class="category-wrapper">
                <div class="category-header ${btnClass ? 'shady-header' : ''}" onclick="toggleCategory(this)">
                    <span>${category.cat}</span>
                    <span class="arrow-icon">â–¼</span>
                </div>
                <div class="items-container">
            `;
            category.items.forEach((item, j) => {
                const id = `${prefix}-${i}-${j}`;
                // Ø¹Ø±Ø¶ Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ù‚Ø¯ÙŠÙ… Ù…Ø´Ø·ÙˆØ¨ Ø¥Ø°Ø§ ÙˆØ¬Ø¯
                const priceDisplay = item.oldP 
                    ? `<span class="shady-price">${item.p} Ø¬.Ù…</span> <span class="old-price">${item.oldP}</span>` 
                    : `<span class="${btnClass ? 'shady-price' : ''}">${item.p} Ø¬.Ù…</span>`;

                html += `
                <div class="menu-item">
                    <div class="item-details">
                        <h4>${item.n}</h4>
                        <div class="item-price">${priceDisplay}</div>
                        ${item.d ? `<p>${item.d}</p>` : ''}
                    </div>
                    <div class="qty-control">
                        <button class="qty-btn ${btnClass}" onclick="updateCart('${id}', ${item.p}, -1)">-</button>
                        <span id="qty-${id}" style="font-weight:bold; min-width:20px; text-align:center">0</span>
                        <button class="qty-btn ${btnClass}" onclick="updateCart('${id}', ${item.p}, 1)">+</button>
                    </div>
                </div>`;
            });
            html += `</div></div>`;
            container.innerHTML += html;
        });
    }

    buildMenu(menuDB, 'menuContainer', 'lunch');
    buildMenu(shadyDB, 'shadyMenuContainer', 'shady', 'shady-btn');

    window.toggleCategory = function(header) {
        header.classList.toggle('active');
        header.nextElementSibling.classList.toggle('show');
    };

    function updateCart(id, price, change) {
        if(!cart[id]) cart[id] = 0;
        cart[id] += change;
        if(cart[id] < 0) cart[id] = 0;
        
        document.getElementById(`qty-${id}`).innerText = cart[id];
        calculateTotal();
    }

    function calculateTotal() {
        totalLunch = 0;
        totalShady = 0;
        
        menuDB.forEach((c, i) => c.items.forEach((item, j) => {
            const id = `lunch-${i}-${j}`;
            if(cart[id]) totalLunch += item.p * cart[id];
        }));

        shadyDB.forEach((c, i) => c.items.forEach((item, j) => {
            const id = `shady-${i}-${j}`;
            if(cart[id]) totalShady += item.p * cart[id]; // Ø§Ù„Ø³Ø¹Ø± Ù‡Ù†Ø§ Ù‡Ùˆ Ø§Ù„Ù…Ø®ÙØ¶
        }));
        
        const grandTotal = totalLunch + totalShady;
        document.getElementById('displayTotal').innerText = grandTotal;
        togglePaymentSection(grandTotal > 0);
    }

    function toggleLunch() {
        const isYes = document.querySelector('input[name="lunchChoice"]:checked').value === "yes";
        document.getElementById('lunchSection').classList.toggle('hidden', !isYes);
        calculateTotal();
    }

    function toggleShady() {
        const isYes = document.querySelector('input[name="shadyChoice"]:checked').value === "yes";
        document.getElementById('shadySection').classList.toggle('hidden', !isYes);
        calculateTotal();
    }

    function togglePaymentSection(show) {
        const paymentSection = document.getElementById('paymentSection');
        const btn = document.getElementById('mainBtn');
        
        if (show) {
            paymentSection.classList.remove('hidden');
            btn.innerText = "ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨ ÙˆØ§Ù„Ø¯ÙØ¹ ğŸš€";
            btn.style.background = "#27ae60";
        } else {
            paymentSection.classList.add('hidden');
            btn.innerText = "ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø­Ø¶ÙˆØ± âœ…";
            btn.style.background = "#800000";
        }
    }

    function previewFile() {
        const file = document.getElementById('receiptFile').files[0];
        if(file) document.getElementById('fileName').innerText = "âœ… ØªÙ… Ø§Ø®ØªÙŠØ§Ø±: " + file.name;
    }

    const toBase64 = file => new Promise((resolve, reject) => {
        const reader = new FileReader();
        reader.readAsDataURL(file);
        reader.onload = () => resolve(reader.result);
        reader.onerror = error => reject(error);
    });

    async function submitForm() {
        const name = document.getElementById('name').value;
        const phone = document.getElementById('phone').value;
        const email = document.getElementById('email').value;
        const catId = document.getElementById('catId').value;
        const grandTotal = totalLunch + totalShady;

        if(!name || !phone || !catId) { alert("Ù…Ù† ÙØ¶Ù„Ùƒ Ø£ÙƒÙ…Ù„ Ø¨ÙŠØ§Ù†Ø§ØªÙƒ Ø§Ù„Ø´Ø®ØµÙŠØ© Ø£ÙˆÙ„Ø§Ù‹"); return; }

        let payload = { name, phone, email, catId };
        let orderText = "";

        if (grandTotal > 0) {
            if (totalLunch > 0) {
                orderText += "--- [Ø·Ù„Ø¨ Ø§Ù„ØºØ¯Ø§Ø¡] ---\n";
                menuDB.forEach((c, i) => c.items.forEach((item, j) => {
                    const id = `lunch-${i}-${j}`;
                    if(cart[id]) orderText += `${item.n} (${cart[id]}) | `;
                }));
                orderText += "\n";
            }
            
            if (totalShady > 0) {
                orderText += "\n--- [Ø·Ù„Ø¨ Ø§Ù„Ø¯ÙˆÙ†Ø§ØªØ³] ---\n";
                shadyDB.forEach((c, i) => c.items.forEach((item, j) => {
                    const id = `shady-${i}-${j}`;
                    if(cart[id]) orderText += `${item.n} (${cart[id]}) | `;
                }));
                orderText += "\n";
            }

            payload.order = orderText;
            payload.total = grandTotal;
            payload.isOrder = "yes";

            const fileInput = document.getElementById('receiptFile');
            if (fileInput.files.length === 0) { alert("ÙŠØ¬Ø¨ Ø±ÙØ¹ ØµÙˆØ±Ø© Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ù„Ø¥ØªÙ…Ø§Ù… Ø§Ù„Ø·Ù„Ø¨"); return; }
            
            try {
                const file = fileInput.files[0];
                payload.file = await toBase64(file);
                payload.fileName = file.name;
                payload.mimeType = file.type;
            } catch(e) { alert("Ø®Ø·Ø£ ÙÙŠ Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„ØµÙˆØ±Ø©"); return; }
        } else {
            payload.isOrder = "no";
            payload.order = "Ø­Ø¶ÙˆØ± ÙÙ‚Ø·";
            payload.total = 0;
        }

        const btn = document.getElementById('mainBtn');
        const oldText = btn.innerText;
        btn.innerText = "Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„...";
        btn.disabled = true;

        fetch(SCRIPT_URL, {
            method: "POST",
            mode: "no-cors",
            body: JSON.stringify(payload)
        }).then(() => {
            alert(grandTotal > 0 ? "ØªÙ… Ø§Ø³ØªÙ„Ø§Ù… Ø·Ù„Ø¨Ùƒ ÙˆØ§Ù„Ø¯ÙØ¹ Ø¨Ù†Ø¬Ø§Ø­!" : "ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø­Ø¶ÙˆØ±Ùƒ Ø¨Ù†Ø¬Ø§Ø­!");
            location.reload();
        }).catch(err => {
            alert("Ø­Ø¯Ø« Ø®Ø·Ø£ØŒ Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰");
            btn.innerText = oldText;
            btn.disabled = false;
        });
    }
</script>

</body>
</html>




